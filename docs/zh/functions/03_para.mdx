# 参数配置

## 功能简介
根据业务场景配置合适的 MySQL 参数可使数据库达到最佳使用状态，更好地支撑业务。MySQL-PXC 实例中默认使用 MySQL 及 Percona 官方提供的系统参数。您也可在界面便捷地配置参数。

平台提供参数模板用于定义一系列您期望的 MySQL 参数。创建实例时可通过参数模板批量修改默认参数，模板中未涉及的参数将维持默认值不变。
实例正常运行后，可更新 MySQL 参数。

更多参数信息请查阅 [MySQL 官网](https://dev.mysql.com/doc/refman/5.7/en/innodb-parameters.html) 及 [Percona 官网](https://docs.percona.com/percona-xtradb-cluster/8.0/) 。

## 注意事项
修改参数配置将逐个重启容器组，可能会造成业务的短暂中断。


## 操作步骤
<Tabs>
<Tab label="命令行操作">
```bash
kubectl patch mysql -n $namespace $name --type='merge' --patch '
spec:
  params:
    mysql:
      mysqld:
        max_connections: "1000"
        expire_logs_days: "7"
'
```
可以通过修改 CR 中的 spec.params.mysql 来修改参数，对应的参数 key 同 MySQL 参数一致。如上，指定 max_connections 为 1000，expire_logs_days 为 7。

</Tab>

<Tab label="界面操作">

#### 使用推荐模板设置参数

**提示**：创建参数模板请参考 [参数模板]。

* 平台提供了多种规格的参数模板，供集群中任意 MySQL-PXC 实例使用。每种规格的参数模板均设置了 `innodb_flush_log_at_trx_commit = 1`、`sync_binlog = 1` 等系统参数，帮助提高 MySQL 安全性。

* MySQL-PXC 实例默认应用名称为 **hhd-1c2g-pxc-template** 的参数模板，您在创建 MySQL-PXC 实例时可根据实际的磁盘介质与实例规格选择对应的参数模板。

#### 更新参数

更新实例现有的参数配置后，实例将自动按顺序重启 MySQL 副本以使变更生效。

##### 操作步骤

1. 在左侧导航栏中，单击 **MySQL-PXC**。

2. 单击 ***命名空间的名称***。

2. 单击 ***实例名称*** 。

3. 在 **参数配置** 页签下，单击 **更新参数**。

4. 配置预期的参数，包括逐个配置，或批量导入。

    **注意**：导入参数时，请确保不包含 MySQL 不支持的参数，否则将导致实例无法启动。
    
5. 单击 **更新**。

##### 相关操作

如需复用其他实例的参数配置，您可以在源实例的 **参数配置** 页签下，单击导出参数，并参考参数模板创建自定义模板并批量导入参数。

</Tab>
</Tabs>